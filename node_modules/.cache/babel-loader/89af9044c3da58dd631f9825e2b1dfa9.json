{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/csabi/OneDrive/Asztali g\\xE9p/Dipmunka/React6/dip6/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/csabi/OneDrive/Asztali g\\xE9p/Dipmunka/React6/dip6/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/csabi/OneDrive/Asztali g\\xE9p/Dipmunka/React6/dip6/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState,useEffect,useContext}from'react';import AuthContext from'./AuthProvider';import axios from'./axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LOGIN_URL='/auth';var Login=function Login(){var _useContext=useContext(AuthContext),setAuth=_useContext.setAuth;var userRef=useRef();var errRef=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),pwd=_useState4[0],setPwd=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),errMsg=_useState6[0],setErrMsg=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),success=_useState8[0],setSuccess=_useState8[1];useEffect(function(){userRef.current.focus();},[]);useEffect(function(){setErrMsg('');},[user,pwd]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _response$data,_response$data2,response,accessToken,roles,_err$response,_err$response2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return axios.post(LOGIN_URL,JSON.stringify({user:user,pwd:pwd}),{headers:{'Content-Type':'application/json'},withCredentials:true});case 4:response=_context.sent;accessToken=response===null||response===void 0?void 0:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.accessToken;roles=response===null||response===void 0?void 0:(_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.roles;setAuth({user:user,pwd:pwd,roles:roles,accessToken:accessToken});setUser('');setPwd('');setSuccess(true);_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);if(!(_context.t0!==null&&_context.t0!==void 0&&_context.t0.response)){setErrMsg('No Server Response');}else if(((_err$response=_context.t0.response)===null||_err$response===void 0?void 0:_err$response.status)===400){setErrMsg('Missing Username or Password');}else if(((_err$response2=_context.t0.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){setErrMsg('Unauthorized');}else{setErrMsg('Login Failed');}errRef.current.focus();case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:success?/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"You are logged in!\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{})]}):/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"p\",{ref:errRef,className:errMsg?'errmsg':'offscreen',\"aria-live\":\"assertive\",children:errMsg}),/*#__PURE__*/_jsx(\"h1\",{children:\"Sign In\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",ref:userRef,autoComplete:\"off\",onChange:function onChange(e){return setUser(e.target.value);},value:user,required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",onChange:function onChange(e){return setPwd(e.target.value);},value:pwd,required:true}),/*#__PURE__*/_jsx(\"button\",{children:\"Sign In\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Need an Account?\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"line\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/register\",children:\"Sign Up\"})})]})]})});};export default Login;","map":{"version":3,"names":["useRef","useState","useEffect","useContext","AuthContext","axios","LOGIN_URL","Login","setAuth","userRef","errRef","user","setUser","pwd","setPwd","errMsg","setErrMsg","success","setSuccess","current","focus","handleSubmit","e","preventDefault","post","JSON","stringify","headers","withCredentials","response","accessToken","data","roles","status","target","value"],"sources":["C:/Users/csabi/OneDrive/Asztali gÃ©p/Dipmunka/React6/dip6/src/other/Login2.js"],"sourcesContent":["import { useRef, useState, useEffect, useContext } from 'react';\r\nimport AuthContext from './AuthProvider';\r\n\r\nimport axios from './axios';\r\nconst LOGIN_URL = '/auth';\r\n\r\nconst Login = () => {\r\n\tconst { setAuth } = useContext(AuthContext);\r\n\tconst userRef = useRef();\r\n\tconst errRef = useRef();\r\n\r\n\tconst [user, setUser] = useState('');\r\n\tconst [pwd, setPwd] = useState('');\r\n\tconst [errMsg, setErrMsg] = useState('');\r\n\tconst [success, setSuccess] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tuserRef.current.focus();\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetErrMsg('');\r\n\t}, [user, pwd]);\r\n\r\n\tconst handleSubmit = async (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await axios.post(\r\n\t\t\t\tLOGIN_URL,\r\n\t\t\t\tJSON.stringify({ user, pwd }),\r\n\t\t\t\t{\r\n\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\t\t\twithCredentials: true,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tconst accessToken = response?.data?.accessToken;\r\n\t\t\tconst roles = response?.data?.roles;\r\n\t\t\tsetAuth({ user, pwd, roles, accessToken });\r\n\t\t\tsetUser('');\r\n\t\t\tsetPwd('');\r\n\t\t\tsetSuccess(true);\r\n\t\t} catch (err) {\r\n\t\t\tif (!err?.response) {\r\n\t\t\t\tsetErrMsg('No Server Response');\r\n\t\t\t} else if (err.response?.status === 400) {\r\n\t\t\t\tsetErrMsg('Missing Username or Password');\r\n\t\t\t} else if (err.response?.status === 401) {\r\n\t\t\t\tsetErrMsg('Unauthorized');\r\n\t\t\t} else {\r\n\t\t\t\tsetErrMsg('Login Failed');\r\n\t\t\t}\r\n\t\t\terrRef.current.focus();\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{success ? (\r\n\t\t\t\t<section>\r\n\t\t\t\t\t<h1>You are logged in!</h1>\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<p>{/* <a href=\"#\">Go to Home</a> */}</p>\r\n\t\t\t\t</section>\r\n\t\t\t) : (\r\n\t\t\t\t<section>\r\n\t\t\t\t\t<p\r\n\t\t\t\t\t\tref={errRef}\r\n\t\t\t\t\t\tclassName={errMsg ? 'errmsg' : 'offscreen'}\r\n\t\t\t\t\t\taria-live=\"assertive\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{errMsg}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<h1>Sign In</h1>\r\n\t\t\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t\t\t<label htmlFor=\"username\">Username:</label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tid=\"username\"\r\n\t\t\t\t\t\t\tref={userRef}\r\n\t\t\t\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\t\t\t\tonChange={(e) => setUser(e.target.value)}\r\n\t\t\t\t\t\t\tvalue={user}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<label htmlFor=\"password\">Password:</label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\tid=\"password\"\r\n\t\t\t\t\t\t\tonChange={(e) => setPwd(e.target.value)}\r\n\t\t\t\t\t\t\tvalue={pwd}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<button>Sign In</button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tNeed an Account?\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t<span className=\"line\">\r\n\t\t\t\t\t\t\t<a href=\"/register\">Sign Up</a>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</section>\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module"}